# EDA Report: Avazu Click-Through Rate Dataset

**분석 일자:** 2024-12-08
**분석 대상:** train.gz (Avazu CTR Prediction Dataset)
**분석 범위:** 500,000 샘플 (전체 40,428,967행 중)

---

## 1. 데이터 개요

### 1.1 기본 정보
- **전체 데이터크기:** 7.82GB (압축)
- **전체 행 수:** 40,428,967
- **샘플 행 수:** 500,000 (분석용)
- **컬럼 수:** 24개
- **기간:** 2014-10-21 ~ 2014-10-31 (10일)

### 1.2 컬럼 구성

| 컬럼명 | 타입 | 설명 |
|--------|------|------|
| id | int | 광고 노출 ID |
| click | int | 클릭 여부 (0=미클릭, 1=클릭) |
| hour | int | 시간 (YYYYMMDDHH 형식) |
| C1 | int | 범주형 피처 1 |
| banner_pos | int | 배너 위치 |
| site_id | str | 사이트 ID |
| site_domain | str | 사이트 도메인 |
| site_category | str | 사이트 카테고리 |
| app_id | str | 앱 ID |
| app_domain | str | 앱 도메인 |
| app_category | str | 앱 카테고리 |
| device_id | str | 기기 ID |
| device_ip | str | 기기 IP |
| device_model | str | 기기 모델 |
| device_type | int | 기기 타입 |
| device_conn_type | int | 기기 연결 타입 |
| C14-C21 | int | 범주형 피처 (14~21) |

---

## 2. 탐색적 분석 (EDA)

### 2.1 데이터 품질

**Null 값 확인:**
- **결과:** 모든 컬럼에서 Null값 0개
- **평가:** ✅ 완전한 데이터 (완전성 100%)

### 2.2 Target 분포 (Click)

```
클릭 안함 (0): 417,963건 (83.59%)
클릭함 (1):    82,037건 (16.41%)

클릭률 (CTR): 16.41%
```

**분석:**
- 강한 클래스 불균형 (약 5:1 비율)
- 불균형 데이터이므로 모델링 시 가중치 조정 필요
- F1-Score, AUC 등의 메트릭 사용 권장

### 2.3 컬럼별 고유값 분석

#### 수치형 컬럼
| 컬럼 | 고유값 개수 | 범위 | 해석 |
|------|-----------|------|------|
| device_type | 4 | 0~5 | 4가지 기기 타입 |
| device_conn_type | 4 | 0~5 | 4가지 연결 타입 |
| banner_pos | 6 | 0~7 | 배너 위치 6가지 |
| C1 | 7 | 1001~1012 | 범주형 피처 7가지 |

#### 범주형 컬럼
| 컬럼 | 고유값 개수 | 해석 |
|------|-----------|------|
| site_id | 1,704 | 1,704개 사이트 |
| site_domain | 1,586 | 1,586개 도메인 |
| device_id | 41,413 | 41,413개 고유 기기 |
| device_ip | 171,304 | 171,304개 고유 IP |
| device_model | 3,967 | 3,967개 기기 모델 |
| app_id | 1,641 | 1,641개 앱 |

### 2.4 기본 통계

#### 수치형 컬럼 통계
```
device_type: 평균 1.04, 최소 0, 최대 5
device_conn_type: 평균 0.22, 최소 0, 최대 5
banner_pos: 평균 0.22, 최소 0, 최대 7
C14: 평균 18193.17, 최소 375, 최대 21705
C15: 평균 319.18, 최소 120, 최대 1024
C16: 평균 56.56, 최소 20, 최대 1024
C17: 평균 2031.63, 최소 112, 최대 2497
C18: 평균 1.11, 최소 0, 최대 3
C19: 평균 201.53, 최소 33, 최대 1835
C20: 평균 42639.89, 최소 -1, 최대 100248
C21: 평균 74.05, 최소 13, 최대 195
```

### 2.5 시각형 분석 결과

**생성된 그래프:**
1. **Click Distribution** - 클릭 비율 확인 (불균형 16.41%)
2. **CTR by Device Type** - 기기 타입별 클릭률 분석
3. **Event Distribution by Hour** - 시간대별 이벤트 분포

**주요 발견:**
- 시간대별 이벤트 수가 균등함 (YYYYMMDDHH 형식)
- 기기 타입별로 CTR 차이 존재

---

## 3. 샘플링 전략

### 3.1 샘플링 방법
- **방법:** Stratified Sampling (층화 샘플링)
- **계층:** click (0/1)
- **목표:** 클릭률 비율 유지

### 3.2 생성된 샘플

| 샘플명 | 파일명 | 행 수 | 용도 | CTR |
|--------|--------|-------|------|-----|
| 소규모 | train_sample_1k.csv | 1,000 | 빠른 테스트 | ~16.41% |
| 중규모 | train_sample_10k.csv | 10,000 | 로컬 개발 | ~16.41% |
| 대규모 | train_sample_50k.csv | 50,000 | 성능 테스트 | ~16.41% |

### 3.3 샘플링 검증
- ✅ 모든 샘플에서 원본 CTR(16.41%) 유지
- ✅ 클래스 불균형 비율 보존
- ✅ Random seed(42)로 재현성 보장

---

## 4. 주요 발견사항

### 4.1 데이터 품질
- ✅ **완전성:** 100% (Null값 없음)
- ✅ **다양성:** 고유값 충분 (device 41K+, IP 171K+)
- ✅ **균형:** 클래스 불균형 존재 (16.41% CTR)

### 4.2 특성 분석
- **고카디널리티:** device_id, device_ip (고유값 많음)
  - 원핫인코딩 시 차원 주의 필요

- **저카디널리티:** device_type, device_conn_type (4개)
  - 원핫인코딩 효율적

- **범주형 변수:** site_id, app_id 등 (1000+개)
  - 타겟 인코딩 또는 임베딩 권장

### 4.3 모델링 권고사항

1. **클래스 불균형 처리**
   - 가중치 조정 (weight_1 / weight_0 = 5:1)
   - SMOTE 또는 언더샘플링 고려

2. **특성 엔지니어링**
   - 고카디널리티 변수: 타겟 인코딩
   - 저카디널리티 변수: 원핫인코딩
   - 상호작용 변수 생성 (예: device_type × device_conn_type)

3. **평가 지표**
   - Accuracy ❌ (불균형 데이터)
   - AUC-ROC ✅
   - F1-Score ✅
   - LogLoss ✅

---

## 5. 다음 단계

### Week 1 - Day 2 이후
1. **Kafka 파이프라인 구축**
   - train_sample_*.csv → Kafka Topic
   - 처리량 테스트 (1000+ msg/sec)

2. **데이터 검증**
   - 샘플 데이터로 Kafka Producer 테스트
   - 메시지 포맷 검증

3. **모니터링 준비**
   - Prometheus 메트릭 수집 설정
   - 처리량 추적

---

## 부록: 파일 위치

```
data/
├── raw/
│   ├── train.gz                    (원본 전체)
│   ├── test.gz
│   └── sampleSubmission.gz
│
└── sample/
    ├── train_sample_1k.csv         (1K 샘플)
    ├── train_sample_10k.csv        (10K 샘플)
    └── train_sample_50k.csv        (50K 샘플)
```

---

**작성자:** AI Assistant
**버전:** 1.0
**마지막 수정:** 2024-12-08